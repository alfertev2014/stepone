# Стандартная библиотека

После реализации рантайма требуется создать стандартную библиотеку. Стандартная библиотека - это то, что загружается в память и обрабатывается голым рантаймом, наполняет контекст всеми необходимыми и часто используемыми функциями.

## Запуск программы

Рантайм языка представляет собой загруженный в память процесса обеъект, через который можно запустить программу. Программой является загруженное в память дерево исходника.

Процесс запуска программы - это применение объекта рантайма к исходнику программы. За это отвечает внешний лаунчер, описание которого находится за пределами языка. Лаунчер - это часть программы, которая должна загрузить и инициализировать рантайм, загрузить в память исходник программы и вызвать применение объекта рантайма к исходнику программы.

## Модульная система

Стандартная библиотека уже должна завязываться на некоторую простую модульную систему. Система модулей подразумевает наличие некого загрузчика модулей (module loader), а также, соглашения, которого должны придерживаться все модули. Модуль - это некоторый распарсенный кусок исходника, который обрабатывается загрузчиком модулей.

В загрузчике модулей определяется процесс загрузки модулей. Загрузчик может быть простым, а может быть наполнен некоторой конкретной сложной логикой. Основной загрузчик модулей в стандартной библиотеке должен быть простым и не привязываться к сильно ограничивающим конкретным правилам. В идеале модульная система должна быть как бы уже представлена в самом языке и не требовать никаких дополнительных библиотек.

Простейшая модульная система может выглядеть следующим образом. Изначально имеется объект рантайма. Лаунчер применяет его к исходнику программы. В начале исходника программы исполняется загрузчик модулей, который имеет доступ ко всем модулям - распарсенным фрагментам исходников. Эти фрагменты могут быть уже представлены тем или иным способом в исходнике программы вместе с загрузчиком модулей, а могут подгружаться или генерироваться динамически в ходе выполнения программы из уже загруженных модулей. Изначально при запуске для всей программы должна быть известна схема загрузки модулей - какие модули должны загружаться сразу при старте программы и в каком порядке. Это есть конфигурация загрузки модулей - описание набора модулей и основной точки входа в программу. Простейший загрузчик модулей может просто применять рантайм к исходнику модуля, а результат этого применения применять к следующему модулю. Каждый загруженный модуль как-то модифицирует контекст исполнения для загрузки следующего модуля. Порядок такой загрузки модулей определяется конфигурацией. Реализация конфигурации должна быть какой-то конкретной и должна быть стандартизирована для данного загрузчика модулей.

Можно предложить несколько способов описания конфигурации загрузки модулей:
- Императивный - когда загрузчик модулей просто передаёт управление (применяет рантайм) к исходнику конфигурации, где императивно прописан порядок загрузки кусков исходников. Там возможны любые управляющие конструкции, которым можно определить сложную сеть зависимостей модулей, но не вполне очевидную.
- Декларативный - требует соглашения о формате описания порядка загрузки модулей и некоторой простой функции, которая это описание читает и выполняет.

Один загруженый модуль может, по сути, быть загрузчиком модулей для другой модульной системы. Поэтому начальный загрузчик модулей может не знать, что там делают загруженные им модули с контекстом. Соглашение о процессе загрузки модулей требуется стандартизировать.

Стандартизация - это выбор какого-то одного конкретного решения задачи из множества возможных и более-менее равносильных. Стандартизировать потребуется начальный процесс загрузки модулей, правила контроля зависимостей.

## Элементы стандартной библиотеки

Цель загрузки стандартной библиотеки - наполнить голый контекст исполения всем необходимым и часто используемым, а потом просто передать исполнение пользовательской программе. Контекст на момент загрузки стандартной библиотеки должен быть стандартизирован - соответствовать определённым правилам.

Среди стандартизированных правил должны быть:
- загрузка пользовательских модулей
- набор макросов для удобного описания пользовательских макросов (лямбды, функции, различные соглашения о передаче параметров в макрос, в функции)
- набор макросов и функций для работы со списками как с фрагментами исходников (quote и eval приёмы передачи управления и генерации исходников, удобная рефлексия)
- набор более-менее удобных функций для работы с числами, строками, списками для всех вариантов соглашений о передаче параметров и использования в управляющих конструкциях
- набор макросов работы с контекстами

Стандартную библиотеку саму можно разделить на модули и подгружать только самое необходимое.

Далее можно реализовать и стандартизировать более практические задачи:
- парсеры и сложная обработка текста
- ввод-вывод, в том числе потоковый
- алгоритмы работы с различными коллекциями
- интерфейс с другими языками, генерация в C
- инлайнеры и другие сложные преобразователи исходников
- средства отладки

Далее можно реализовать обёртки над во
