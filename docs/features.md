# Описание Языка

Сущность Языка можно грубо разделить на несколько слоёв. Каждый слой требует стандартизации, чтобы он имел одинаковую структуру и поведение на множестве различных платформ. При этом слои можно использовать по отдельности, поверх одного слоя можно наложить другой с альтернативным стандартом. Чем ниже слой, тем более жёсткий стандарт. Верхние слои близки к пользовательскому коду и могут быть заменены при желании альтернативным стандартом.

Слои, которые можно выделить для стандартизации:

* Объекты AST и семантика их интерпретации
* Типы-расширения и API создания расширений для конкретной платформы
* Конкретный (строковый) синтаксис исходников
* Содержимое контекста базового интерпретатора
* Система модулей
* Слои стандартной библиотеки

## Объекты AST

Синтаксис Языка имеет два вида. _Абстрактный синтаксис_ описывает правила построения древовидных структур, представляющих программы, а _конкретный синтаксис_ предназначен для выражения программ в виде символьных строк. Исходный код в конкретном синтаксисе может быть транслирован в представление с абстрактным синтаксисом с помощью _парсера_.

Слои абстрактного и конкретного синтаксиса полностью независимы друг от друга. Связь между ними выражается парсером. Возможно построение рантайма Языка для исполнения программ в абстрактном синтаксисе без необходимости формировать строки в конкретном синтаксисе. Платформа может позволять напрямую формировать программы в абстрактном синтаксисе и подавать их на интерпретацию рантайму. Используя парсер можно использовать рантайм для исполнения программ, написанных в конкретном синтаксисе. Возможно построение такого рантайма, который непосредственно исполняет программы в конкретном синтаксисе.

_Абстрактрое синтаксическое дерево_ (AST) является представлением программ на Языке в абстрактном синтаксисе. Оно состоит из узлов из ограниченного набора типов. Каждый узел далее называется просто _объектом_.

_Исходником_ на языке Языке будет называться любой фрагмент AST, предназначенный для выполнения в некотором _контексте_. Контекст выполнения исходника задаётся средой исполнения и другими фрагментами исходников.

Все объекты, из которых складывается AST исходников, представляются расположенными в некоторой области абстрактной _памяти_. Объекты, расположенные в разных местах памяти, считаются различными. Два объекта считаются совпадающими, если они являются одним и тем же объектом в памяти. Таким образом, расположение объекта в памяти является его идентифицирующим свойством. Адрес расположения объекта в памяти называется ссылкой. Ссылка - это данные для обращения к объекту, на который она указывает. Она может быть частью данных других объектов. Для ссылок определена операция проверки на равенство.

Объекты в AST можно поделить на две большие группы: пары и атомы, соответствующие промежуточным узлам бинарного дерева и его листьям.

Пары - это единственный встроенный способ представления составных структур исходников. Атомы предполагаются неделелимыми с точки зрения выполнения программ. Внутреннее устройство атомов скрыто в деталях реализации. В AST атомы являются листовыми узлами, а пары - промежуточными.


К объекту могут быть применены операции _вычисления_ - eval, и _применения_ его к другому объекту - apply. Обе эти операции выполняются в _контексте_ вычисления. Контекстом вычисления называется состояние окружения, в котором среда исполнения вычисляет тот или иной объект. Результатом вычислени может быть другой объект или один из уже существующих в памяти.

### Основные типы объектов

_Пара_ - это объект из двух полей car и cdr, являющихся ссылками на другие объекты. Для пар существуют операции _конструирования_ пары из двух объектов - cons, и операции _получения_ первого и второго элементов пары - car и cdr.

Остальные объекты являются _атомами_. Атомы делятся на две группы: символы и константы. Они отличаются своей интерпретацией в ходе вычисления.

_Константы_ - это атомы, которые в результате своего вычисления возвращают самих себя.

_Символы_ - это атомы, результат вычисления которых зависит от контекста вычисления. В контексте вычисления хранятся соответствия символов их значениям. Основное назначение символов - проверка их на равенство. Они используются как ключи в таблицах. Одной из таблиц, использующих символы, является таблица в контексте вычисления, по которой символам ставятся в соответствие их значения. Таким образом, символы могут играть роль идентификаторов "переменных".

Среди констант выделяется особая группа - _значения_. Значение, как и константа, в результате своего вычисления возвращает саму себя. Также значение возвращает само себя как результат применения его к чему-либо. Остальные константы являются макросами.

### Правила интерпретации


## API создания расширений


## Конкретный синтаксис

### S-выражения

### Парсер


## Базовый контекст




## Система модулей




## Cтандартная библиотека

